<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Plan with Purpose</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f3dd;
    }

    .container {
      display: flex;
    }

    /* Sidebar */
    .sidebar {
      width: 200px;
      background-color: #dbe4c6;
      height: 100vh;
      padding-top: 30px;
      box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
      position: fixed;
    }

    .sidebar button {
      width: 100%;
      padding: 15px;
      font-size: 16px;
      background: none;
      border: none;
      text-align: left;
      cursor: pointer;
      color: #2e2e2e;
    }

    .sidebar button:hover {
      background-color: #c1cbaa;
    }

    .main {
      margin-left: 200px;
      padding: 20px;
      width: calc(100% - 200px);
      position: relative;
    }

    .user-name {
      position: absolute;
      top: 20px;
      right: 30px;
    }

    .user-name input {
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
      width: 180px;
    }

    .hidden {
      display: none;
    }

    h1 {
      text-align: center;
      font-size: 36px;
      margin-top: 10px;
    }

    .tagline {
      text-align: center;
      font-style: italic;
      color: #555;
      margin-bottom: 20px;
    }

    .form-container {
      max-width: 800px;
      margin: 0 auto 20px;
      padding: 20px;
      background: #fff7df;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }

    input, select, button {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
    }

    table {
      width: 90%;
      margin: 0 auto;
      border-collapse: collapse;
      background-color: white;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    th, td {
      border: 1px solid #ccc;
      text-align: center;
      padding: 10px;
      min-height: 60px;
    }

    th {
      background-color: #d5e8c8;
    }

    .time-slot {
      font-weight: bold;
      background-color: #f0f7e0;
    }

    .task-item {
      padding: 6px;
      margin: 4px 0;
      border-radius: 6px;
      cursor: move;
    }

    .task-item.present {
      background-color: #78866B;
      color: white;
    }

    .task-item.future {
      background-color: #C1CBAA;
      color: black;
    }

    .color-legend {
      text-align: center;
      margin-top: 20px;
    }

    .color-legend span {
      display: inline-block;
      padding: 5px 15px;
      margin: 0 10px;
      border-radius: 6px;
      font-weight: bold;
    }

    .legend-present { background-color: #78866B; color: white; }
    .legend-future { background-color: #C1CBAA; color: black; }

    .quote-box {
      margin-top: 20px;
      text-align: center;
      font-size: 20px;
      font-style: italic;
      color: #2e2e2e;
      background: #fffef2;
      padding: 12px;
      border-radius: 10px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .notes-container {
      max-width: 700px;
      margin: 0 auto;
      padding: 20px;
      background: #fffef2;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .notes-form {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .note-bubble {
      background-color: #d5e8c8;
      padding: 12px 15px;
      border-radius: 16px;
      margin: 8px 0;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .note-bubble:hover {
      background-color: #c1cbaa;
    }

    .export-container {
      text-align: center;
      margin-top: 60px;
    }

    .export-container button {
      margin: 10px;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 16px;
      border: none;
      background-color: #dbe4c6;
      cursor: pointer;
    }

    .export-container button:hover {
      background-color: #c1cbaa;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="sidebar">
      <button onclick="showPage('tasksPage')">üóìÔ∏è Tasks</button>
      <button onclick="showPage('notesPage')">üìù Notes</button>
      <button onclick="showPage('exportPage')">üì§ Export</button>
    </div>

    <div class="main">
      <div class="user-name">
        <input type="text" id="userName" placeholder="Enter your name..." />
      </div>

      <!-- TASKS PAGE -->
      <div id="tasksPage">
        <h1>Plan with Purpose</h1>
        <div class="tagline">No Time No Life</div>

        <div class="form-container">
          <input type="text" id="task" placeholder="Task">
          <select id="day">
            <option value="">Select Day</option>
            <option value="Monday">Monday</option>
            <option value="Tuesday">Tuesday</option>
            <option value="Wednesday">Wednesday</option>
            <option value="Thursday">Thursday</option>
            <option value="Friday">Friday</option>
            <option value="Saturday">Saturday</option>
            <option value="Sunday">Sunday</option>
          </select>
          <input type="text" id="time" placeholder="Time (e.g. 09.00 AM)">
          <select id="importance">
            <option value="">Now or Upcoming?</option>
            <option value="present">Now</option>
            <option value="future">Upcoming</option>
          </select>
          <button id="addBtn">Add Task</button>
        </div>

        <table>
          <tr>
            <th></th>
            <th>Monday</th>
            <th>Tuesday</th>
            <th>Wednesday</th>
            <th>Thursday</th>
            <th>Friday</th>
            <th>Saturday</th>
            <th>Sunday</th>
          </tr>
          <tr>
            <td class="time-slot">Morning</td>
            <td id="Monday-morning"></td>
            <td id="Tuesday-morning"></td>
            <td id="Wednesday-morning"></td>
            <td id="Thursday-morning"></td>
            <td id="Friday-morning"></td>
            <td id="Saturday-morning"></td>
            <td id="Sunday-morning"></td>
          </tr>
          <tr>
            <td class="time-slot">Afternoon</td>
            <td id="Monday-afternoon"></td>
            <td id="Tuesday-afternoon"></td>
            <td id="Wednesday-afternoon"></td>
            <td id="Thursday-afternoon"></td>
            <td id="Friday-afternoon"></td>
            <td id="Saturday-afternoon"></td>
            <td id="Sunday-afternoon"></td>
          </tr>
        </table>

        <div class="color-legend">
          <p><strong>Color Guide:</strong></p>
          <span class="legend-present">Now</span>
          <span class="legend-future">Upcoming</span>
        </div>

        <div class="quote-box">
          <strong>Daily Quote:</strong> <span id="quoteText"></span>
        </div>
      </div>

      <!-- NOTES PAGE -->
      <div id="notesPage" class="hidden">
        <h1>Notes</h1>
        <div class="notes-container">
          <div class="notes-form">
            <input type="text" id="noteInput" placeholder="Write a note..." style="flex: 1;">
            <button onclick="addNote()">Send</button>
          </div>
          <div id="noteList"></div>
        </div>
      </div>

      <!-- EXPORT PAGE -->
      <div id="exportPage" class="hidden">
        <h1>Export Tasks</h1>
        <div class="export-container">
          <button onclick="exportTasks('csv')">Download CSV</button>
          <button onclick="exportTasks('json')">Download JSON</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    function showPage(id) {
      document.querySelectorAll(".main > div:not(.user-name)").forEach(div => {
        div.classList.add("hidden");
      });
      document.getElementById(id).classList.remove("hidden");
    }

    document.addEventListener("DOMContentLoaded", () => {
      const quotes = [
        "Small progress is still progress.",
        "Productivity is not about doing more, but doing what matters.",
        "Believe in your grind. Rest if you must, but don‚Äôt quit.",
        "The key is not to prioritize what's on your schedule, but to schedule your priorities."
      ];
      document.getElementById("quoteText").textContent = quotes[new Date().getDate() % quotes.length];

      const nameInput = document.getElementById("userName");
      nameInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          nameInput.disabled = true;
        }
      });

      function parseTime12Hour(timeStr) {
        const match = timeStr.match(/^(\d{1,2})[:\.](\d{2})\s?(AM|PM)$/i);
        if (!match) return null;
        let hour = parseInt(match[1]);
        const minute = parseInt(match[2]);
        const period = match[3].toUpperCase();
        if (period === "PM" && hour !== 12) hour += 12;
        if (period === "AM" && hour === 12) hour = 0;
        return {
          hour,
          minute,
          formatted: `${match[1]}.${match[2]} ${period}`
        };
      }

      window.tasks = [];

      function createTaskElement(taskData) {
        const div = document.createElement("div");
        div.className = `task-item ${taskData.importance}`;
        div.textContent = `${taskData.task} (${taskData.time})`;
        div.draggable = true;
        div.dataset.id = crypto.randomUUID();

        div.addEventListener("dragstart", (e) => {
          e.dataTransfer.setData("text/plain", JSON.stringify({
            ...taskData,
            text: div.textContent,
            elementId: div.dataset.id
          }));
        });

        div.onclick = () => {
          div.remove();
          window.tasks = window.tasks.filter(t => t.id !== div.dataset.id);
        };

        return div;
      }

      function addTask() {
        const taskInput = document.getElementById("task");
        const dayInput = document.getElementById("day");
        const timeInput = document.getElementById("time");
        const importanceInput = document.getElementById("importance");

        const task = taskInput.value.trim();
        const day = dayInput.value;
        const timeObj = parseTime12Hour(timeInput.value.trim());
        const importance = importanceInput.value;

        if (!task || !day || !timeObj || !importance) {
          alert("Please enter all required fields.");
          return;
        }

        const { hour, formatted } = timeObj;
        const slot = hour < 12 ? "morning" : "afternoon";
        const cellId = `${day}-${slot}`;
        const cell = document.getElementById(cellId);

        const taskData = { task, day, time: formatted, slot, importance, id: crypto.randomUUID() };
        const taskElement = createTaskElement(taskData);
        cell.appendChild(taskElement);
        window.tasks.push(taskData);

        taskInput.value = "";
        timeInput.value = "";
        dayInput.selectedIndex = 0;
        importanceInput.selectedIndex = 0;
      }

      document.querySelectorAll("td[id]").forEach(cell => {
        cell.addEventListener("dragover", e => e.preventDefault());
        cell.addEventListener("drop", e => {
          e.preventDefault();
          const data = JSON.parse(e.dataTransfer.getData("text/plain"));
          const dragged = document.querySelector(`[data-id="${data.elementId}"]`);
          if (!dragged) return;

          cell.appendChild(dragged);
          dragged.onclick = () => {
            dragged.remove();
            window.tasks = window.tasks.filter(t => t.id !== dragged.dataset.id);
          };
        });
      });

      document.getElementById("addBtn").addEventListener("click", addTask);

      window.exportTasks = function (format) {
        if (format === 'json') {
          const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(window.tasks, null, 2));
          const link = document.createElement('a');
          link.href = dataStr;
          link.download = "tasks.json";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        } else if (format === 'csv') {
          const header = "Task,Day,Time,Slot,Status\n";
          const rows = window.tasks.map(t => `${t.task},${t.day},${t.time},${t.slot},${t.importance}`).join("\n");
          const dataStr = "data:text/csv;charset=utf-8," + encodeURIComponent(header + rows);
          const link = document.createElement('a');
          link.href = dataStr;
          link.download = "tasks.csv";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        }
      };

      window.addNote = function () {
        const input = document.getElementById("noteInput");
        const noteText = input.value.trim();
        if (!noteText) return;

        const note = document.createElement("div");
        note.className = "note-bubble";
        note.textContent = noteText;
        note.onclick = () => note.remove();

        document.getElementById("noteList").appendChild(note);
        input.value = "";
      };
    });
  </script>
</body>
</html>
